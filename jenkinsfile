pipeline{
	agent any
	//TESTE WEBHOOK 2
	triggers {
        githubPush()  
    }

	stages{
	
		stage('Build/Run Image Backend'){
			steps{
				script{
					def buildId = env.BUILD_ID
					bat "echo %BUILD_ID%"

					bat 'docker build -t lucasycosta/nginx:${buildId} .'
				}
			}
		}
		
		stage('Deploy image'){
			steps{
				script{
					bat 'docker run -dp 80:80 lucasycosta/nginx:${buildId}'

					//writeFile file: '/home/ec2-user/nova_imagem.txt', text: "zeussh/mapper-calculadora:$BUILD_ID"
				}
			}
		}

	}
}