pipeline{
	agent any
	//TESTE WEBHOOK 2
	triggers {
        githubPush()  
    }

	stages{
	
		stage('Build/Run Image Backend'){
			steps{
				script{
					def buildId = env.BUILD_ID
					sh 'echo $BUILD_ID'

					sh 'docker build -t lucasycosta/nginx:$BUILD_ID .'
				}
			}
		}
		
		stage('Deploy image'){
			steps{
				script{
					sh 'docker run -dp 80:80 lucasycosta/nginx:$BUILD_ID'

					//writeFile file: '/home/ec2-user/nova_imagem.txt', text: "zeussh/mapper-calculadora:$BUILD_ID"
				}
			}
		}

	}
}